name:          pinktrace
version:       #VERSION#
synopsis:      Haskell bindings to Pink's Tracing Library
homepage:      http://dev.exherbo.org/~alip/pinktrace
license:       BSD3
author:        Ali Polatel
maintainer:    alip@exherbo.org
category:      System
build-type:    Custom
cabal-version: >=1.2

flag test
  description: build test programs
  default: False

library
  hs-source-dirs: haskell
  exposed-modules:
    System.PinkTrace
    System.PinkTrace.Bitness
    System.PinkTrace.Event
    System.PinkTrace.Socket
    System.PinkTrace.String
    System.PinkTrace.SystemCall
    System.PinkTrace.Trace
  c-sources:
    haskell/cbits/HsWaitPid.c
    haskell/cbits/HsSocket.c
  build-depends: base, network, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include

executable test01TraceMe
  main-is: test01TraceMe.lhs
  hs-source-dirs: haskell, haskell/tests
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !flag(test)
    buildable: False

executable test02TraceSignal
  main-is: test02TraceSignal.lhs
  hs-source-dirs: haskell, haskell/tests
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !flag(test)
    buildable: False

executable testFreeBSD01TraceCont
  main-is: test01TraceCont.lhs
  hs-source-dirs: haskell haskell/tests/freebsd
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !os(freebsd)
    buildable: False
  if !flag(test)
    buildable: False

executable testFreeBSD02TraceContSignal
  main-is: test02TraceContSignal.lhs
  hs-source-dirs: haskell haskell/tests/freebsd
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !os(freebsd)
    buildable: False
  if !flag(test)
    buildable: False

executable testFreeBSD03TraceKill
  main-is: test03TraceKill.lhs
  hs-source-dirs: haskell haskell/tests/freebsd
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !os(freebsd)
    buildable: False
  if !flag(test)
    buildable: False

executable testFreeBSD04TraceSingleStep
  main-is: test04TraceSingleStep.lhs
  hs-source-dirs: haskell haskell/tests/freebsd
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !os(freebsd)
    buildable: False
  if !flag(test)
    buildable: False

executable testFreeBSD05TraceSingleStepSignal
  main-is: test05TraceSingleStepSignal.lhs
  hs-source-dirs: haskell haskell/tests/freebsd
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !os(freebsd)
    buildable: False
  if !flag(test)
    buildable: False

executable testFreeBSD06TraceSystemCall
  main-is: test06TraceSystemCall.lhs
  hs-source-dirs: haskell haskell/tests/freebsd
  other-modules:
    System.PinkTrace.Trace
  build-depends: base, unix
  build-tools: hsc2hs
  cc-options: -std=c99 #PINKTRACE_CFLAGS#
  ghc-options: -Wall
  extra-libraries: pinktrace_#PINKTRACE_PC_SLOT#
  extra-lib-dirs: #TOP_BUILDDIR#/src/.libs
  include-dirs: #TOP_SRCDIR#/include
  include-dirs: #TOP_SRCDIR#/haskell/include
  if !os(freebsd)
    buildable: False
  if !flag(test)
    buildable: False
